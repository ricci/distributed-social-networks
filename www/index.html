<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="description" content="A site with statistics regarding the decentralization status of various web services" />
    <meta charset="utf-8">
    <title>Are We Decentralized Yet?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Robert Ricci">

    <script type="text/javascript" src="justgage-1.2.2/raphael-2.1.4.min.js""></script>
    <script type="text/javascript" src="justgage-1.2.2/justgage.js"></script>

    <script type="text/javascript" src="data.js"></script>

    <link rel="stylesheet" href="css/index.css">

</head>

<body>
  
    <h1>Are We Decentralized Yet?</h1>

    <noscript>
        <div style="color: red; font-weight: bold; text-align: center">
          ⚠️ JavaScript is disabled in your browser. Please enable it to use this site properly.
        </div>
    </noscript>

    <div class="container">
      <h2>How Concentrated Is The:</h2>
      <div class="rating">
        <h3>Fediverse</h3>
        <h5>Mastodon, Pixelfed, etc.</h5>
        <div id="gageFedi" class="gage"></div>
        <table>
            <tr><th>Servers</th><td><span id="fediServers"></span></td></tr>
            <tr><th>Biggest</th><td><span id="fediBiggestAbs"></span></td><td>(<span id="fediBiggestPct"></span>%)</td></tr>
            <tr><th>Rest</th><td><span id="fediRestAbs"></span></td><td>(<span id="fediRestPct"></span>%)</td></tr>
        </table>
      </div>
      <div class="rating">
        <h3>Atmosphere</h3>
        <h5>Bluesky, WhiteWind, etc.</h5>
        <div id="gageAtmosphere" class="gage"></div>
        <table>
            <tr><th>Servers</th><td><span id="atServers"></span></td></tr>
            <tr><th>Biggest</th><td><span id="atBiggestAbs"></span></td><td>(<span id="atBiggestPct"></span>%)</td></tr>
            <tr><th>Rest</th><td><span id="atRestAbs"></span></td><td>(<span id="atRestPct"></span>%)</td></tr>
        </table>
      </div>
      <h4>Data last updated: <span id="lastUpdate"></span></h4>
    </div>

    <div class="container">
      <p>
        This page measures the concentration of the <a
          href="https://fediverse.party/">Fediverse</a> and the <a
          href="https://atproto.com/">Atmosphere</a> according to the
        <a href="https://en.wikipedia.org/wiki/Herfindahl%E2%80%93Hirschman_index">Herfindahl–Hirschman
          Index</a> (HHI),
        an indicator from economics used to measure competition between firms in
        an industry.
        Mathematically, HHI is the sum of the squares of market shares of all servers.
      </p>

      <p>
        Values close to zero indicate perfectly competitive markets (eg. many servers, with users
        spread evenly), while values close to 10000 indicate highly concentrated monopolies (eg.
        most users on a single server). In economics, values below 100 are considered
        "Highly Competitive", below 1500 is "Unconcentrated", and above 2500 is
        considered "Highly Concentrated".
      </p>

      <p>
        This site currently measures the concentration of user data for active users: in the
        Fediverse, this data is on <a href="https://w3c.github.io/activitypub/#server-to-server-interactions">servers</a> (also known as instances);
        in the Atmosphere, it is on the
        <a
          href="https://atproto.com/guides/glossary#pds-personal-data-server">PDSes</a>
        that host users' <a
          href="https://atproto.com/guides/glossary#data-repo">data repos</a>. Other metrics and
        comparisons are possible, and I'm interested in exploring them.
      </p>

      <p>
        Code and data are available <a href="https://github.com/ricci/distributed-social-networks/">on
          GitHub</a>.
        Comments and pull requests, including other metrics for measuring
        distribution and resiliency, are welcome!
      </p>

      <p>
        By Rob Ricci: <a href="https://discuss.systems/@ricci">@ricci@discuss.systems</a> / 
            <a href="https://bsky.app/profile/ricci.io">@ricci.io</a> 
      </p>

          
    </div>


    <script>
    var defaults = {
      min: 0,
      max: 10000,
      titleFontFamily: "Kade-Regular",
      valueFontFamily: "Kade-Regular",
      valueFontColor: "white",
      txtMinimum: "competitive", 
      txtMaximum: "concentrated", 
      pointer: "true",
      titlePosition: "below",
      pointerOptions: {
          toplength: -10,
          bottomlength: 5,
          bottomwidth: 6,
          color: '#8e8e93',
          stroke: '#ffffff',
          stroke_width: 2,
          stroke_linecap: 'round'
        },
    };

    var hhi_values = [

    ];

    var gFedi = new JustGage({
      id: "gageFedi",
      value: data["fedi"]["HHI"],
      defaults
    });
    var gAtmpsphere = new JustGage({
      id: "gageAtmosphere",
      value: data["at"]["HHI"],
      defaults
    });

    function addCommas(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    document.getElementById("lastUpdate").textContent = data.lastUpdate; 
    document.getElementById("fediServers").textContent = addCommas(data.fedi.servers);
    document.getElementById("atServers").textContent = addCommas(data.at.servers);
    document.getElementById("fediBiggestAbs").textContent = addCommas(data.fedi.biggest_abs);
    document.getElementById("fediBiggestPct").textContent = data.fedi.biggest_pct;
    document.getElementById("atBiggestAbs").textContent = addCommas(data.at.biggest_abs);
    document.getElementById("atBiggestPct").textContent = data.at.biggest_pct;
    document.getElementById("fediRestAbs").textContent = addCommas(data.fedi.rest_abs);
    document.getElementById("fediRestPct").textContent = data.fedi.rest_pct;
    document.getElementById("atRestAbs").textContent = addCommas(data.at.rest_abs);
    document.getElementById("atRestPct").textContent = data.at.rest_pct;
    </script>

</body>
</html>
