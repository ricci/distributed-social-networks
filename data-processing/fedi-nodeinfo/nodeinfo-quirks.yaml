# Quirks config file
{
  # Keyed by software, list of quirks
  "software": {
    # These should considered inactive if they have zero MAU.
    # If the MAU reported is greater than the number of total users, this is
    # acceptable, since deleted users may be included in MAU but are not counted
    # in the total.
    "fedibird": [ # masto fork
      "zero_monthly_skip",
      "trust_monthly_gt_total"
    ],
    "kmyblue": [ # masto fork
      "zero_monthly_skip",
      "trust_monthly_gt_total"
    ],
    "mastodon": [
      "zero_monthly_skip",
      "trust_monthly_gt_total"
    ],
    "pixelfed": [
      "zero_monthly_skip",
      "trust_monthly_gt_total"
    ],

    # Ghost only reports a single user, and reports nothing about posts. So that
    # we don't skip ghost entirely, we will go ahead and count that user
    "ghost": [
      "monthly_from_total",
      "cms"
    ],

    # Wordpress is a little odd; recent versions of the activitypub plugin
    # report the number of users who have activitypub turned on in the total
    # field, and the number of active users in the the monthly field - regardless
    # of whether their account has AP enabled or not. So, we go with the smaller
    # of the two values.
    "wordpress": [
      "cap_monthly_to_total",
      "cms"
    ],

    # This is a bridge, but it doesn't report users
    "ccworld-ap-bridge": [
      "relay",
      "no_monthly_users"
    ]
  },

  # Keyed by quirk, list of software
  "quirks": {
    # These don't report monthly users, and I haven't figured out a way to
    # make an educated guess
    "no_monthly_users": [
      "bonfire",
      "careercupid",
      "forte",
      "gancio",
      "gnusocial",
      "lipupini",
      "mobilizon",
      "tanukey",
      "truefans",
      "webfan",
      "wildebeest",
      "wellesley" # Hard-coded totals/MAU; skip instead of counting.
    ],

    # These do report monthly users, but may give an empty report which should
    # be treated as zero
    "zero_monthly_skip": [
      "funkwhale",
      "zer0"
    ],

    # For these, we assume that the number of total users is a reasonably proxy
    # for the number of monthly users
    "monthly_from_total": [
    ],

    # These may or may not report monthly users; if they don't, skip them;
    # writefreely in partciular has a switch to enable public stats; if it's
    # off, it reports total users but omits monthly users
    "conditional_no_monthly_users": [
      "writefreely"
    ],

    # See comment above for mastodon, etc.
    "trust_monthly_gt_total": [
      "lemmy"
    ],

    # See comment above for Wordpress
    "cap_monthly_to_total": [],

    # This software reports an absurd number of total users, but seems to
    # report reasonable monthly users
    "cap_total_to_monthly": [
      "yellbot"
    ],

    # These are bridges; they report the number of users of various protocols.
    # We add up all users that are *not* activitypub users, because this tells
    # us how many accounts from other protocols are made available in
    # activitypub by the bridge. It's not monthly, unforuntately, but we do
    # count it as such.
    "use_metadata_non_activitypub_users": [
      "bridgy-fed",
      "mostr"
    ],

    # These report total users, but not monthly active users. What we do for
    # these is look back in the history that we keep to see if the number of
    # local posts has gone up in the last month; if not, we consider the
    # instance inactive, ie. 0 monthly users. If it is active, we consider all
    # users active. This is not ideal, but: these are all used for small (often
    # single-user) instances, making this an OK heuristic, and also, we are going
    # to undercount re: instances where people read but don't post, so a bit of
    # overcounting is probably not going to hurt
    "detect_activity_from_posts": [
      "gotosocial",   # As of v 0.18, puts up a robots.txt that allows
                      # fetchining nodeinfo if and only if real stats are being
                      # reported
      "microblogpub", # Single-user software
      "takahe"
    ],
    
    # Same as above, but this software also reports comments in addition to posts
    "detect_activity_from_posts_and_comments": [
      "plume"
    ],

    # We don't count users reported by relays; since they are relaying content
    # produced on other intances, they don't add to the number of users in the 
    # fediverse
    "relay": [
      "activityrelay",
      "activity-relay",
      "aoderelay",
      "pub-relay"
    ],

    # CMSes are not currently treated differently, but they are flagged just in 
    # case it becomes useful to do so
    "cms": [
      "drupal",
      "sutty-distributed-press"
    ],

    # Not known to have any reporting quirks
    "none": [
      "betula", # Hard-codes users to 1; acceptable for single-user software
      "bookwyrm",
      "bovine",
      "brighteon",
      "elektrine",
      "flohmarkt",
      "forgejo",
      "friendica",
      "gitea",
      "hackerspub",
      "hollo",
      "hometown",
      "hubzilla",
      "iceshrimp.net",
      "incise",
      "kbin",
      "killbait",
      "ktistec",
      "loops",
      "maanyfold",
      "mammuthus",
      "mbin",
      "microdotblog",
      "mitra",
      "neodb",
      "owncast", # Hard-codes users to 1; acceptable for single-user software
      "peertube",
      "piefed",
      "postmarks",
      "pulsar",
      "smithereen",
      "snac",
      "wafrn",
      "vernissage",
      "wxwclub"
    ]
  },

  # Minimum versions for software (based on software.version)
  "minimum_versions": {
    "gotosocial": "0.18.0", # Some earlier versions might lie about user counts
                            # without signaling this via robots.txt
                            
    "nodebbb": "4.8.0"      # This version started reporting federation state in
                            # the metadata; earlier versions, we can't tell if it's
                            # federating or not.
  },

   # Lists of misskey and pleroma forks
  "forks": {
    "misskey": [
      "calckey",
      "cherrypick",
      "firefish",
      "foundkey",
      "iceshark",
      "iceshrimp",
      "meisskey",
      "misskey",
      "sharkey",
      "yojo-art"
    ],
    "pleroma": [
      "akkoma",
      "pleroma"
    ]
  }
}
